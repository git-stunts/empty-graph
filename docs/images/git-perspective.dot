digraph GitPerspective {
    // Graph settings
    rankdir=TB;
    splines=ortho;
    nodesep=0.8;
    ranksep=1.0;
    bgcolor="white";
    fontname="Helvetica";

    // Node defaults
    node [
        fontname="Helvetica",
        fontsize=11,
        style="filled,rounded",
        shape=box,
        fillcolor="#e3f2fd",
        color="#1976d2",
        penwidth=2
    ];

    // Edge defaults
    edge [
        fontname="Helvetica",
        fontsize=9,
        color="#616161",
        penwidth=1.5
    ];

    // Title
    labelloc="t";
    label=<<b>Git Perspective: Empty Tree Pattern</b><br/><font point-size="10">All commits point to the same empty tree â€” no files created</font>>;
    fontsize=14;

    // The Empty Tree (special node)
    empty_tree [
        label=<<b>Empty Tree</b><br/><font point-size="9" color="#e65100">4b825dc642cb...</font>>,
        fillcolor="#fff3e0",
        color="#e65100",
        shape=cylinder,
        penwidth=2
    ];

    // Commit nodes
    subgraph cluster_commits {
        label="Commits (contain event data in messages)";
        style=dashed;
        color="#90a4ae";
        fontsize=10;

        order_created [
            label=<<b>a1b2c3d</b><br/><font point-size="9">order-created</font><br/><font point-size="8" color="#666">{"orderId":"ORD-001"}</font>>
        ];

        item_added_1 [
            label=<<b>b2c3d4e</b><br/><font point-size="9">item-added</font><br/><font point-size="8" color="#666">{"sku":"WIDGET-1"}</font>>
        ];

        item_added_2 [
            label=<<b>c3d4e5f</b><br/><font point-size="9">item-added</font><br/><font point-size="8" color="#666">{"sku":"GADGET-2"}</font>>
        ];

        payment [
            label=<<b>d4e5f6a</b><br/><font point-size="9">payment-received</font><br/><font point-size="8" color="#666">{"amount":99.99}</font>>,
            fillcolor="#e8f5e9",
            color="#388e3c"
        ];

        shipped [
            label=<<b>e5f6a7b</b><br/><font point-size="9">order-shipped</font><br/><font point-size="8" color="#666">{"tracking":"1Z999"}</font>>
        ];
    }

    // Parent relationships (solid arrows)
    order_created -> item_added_1 [label="parent", style=solid];
    order_created -> item_added_2 [label="parent", style=solid];
    item_added_1 -> payment [label="parent", style=solid];
    item_added_2 -> payment [label="parent", style=solid];
    payment -> shipped [label="parent", style=solid];

    // Tree pointers (dashed to empty tree)
    order_created -> empty_tree [style=dashed, color="#e65100", constraint=false];
    item_added_1 -> empty_tree [style=dashed, color="#e65100", constraint=false];
    item_added_2 -> empty_tree [style=dashed, color="#e65100", constraint=false];
    payment -> empty_tree [style=dashed, color="#e65100", constraint=false];
    shipped -> empty_tree [style=dashed, color="#e65100", constraint=false];

    // Legend
    subgraph cluster_legend {
        label="Legend";
        style=rounded;
        color="#bdbdbd";
        fontsize=10;

        leg1 [label="Commit", shape=box, fillcolor="#e3f2fd", color="#1976d2"];
        leg2 [label="Merge", shape=box, fillcolor="#e8f5e9", color="#388e3c"];
        leg3 [label="Empty Tree", shape=cylinder, fillcolor="#fff3e0", color="#e65100"];

        leg1 -> leg2 [style=invis];
        leg2 -> leg3 [style=invis];
    }
}
