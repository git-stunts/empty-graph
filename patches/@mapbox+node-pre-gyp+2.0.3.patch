diff --git a/node_modules/@mapbox/node-pre-gyp/lib/util/versioning.js b/node_modules/@mapbox/node-pre-gyp/lib/util/versioning.js
index b69b367..2d3ffe0 100644
--- a/node_modules/@mapbox/node-pre-gyp/lib/util/versioning.js
+++ b/node_modules/@mapbox/node-pre-gyp/lib/util/versioning.js
@@ -4,7 +4,7 @@ module.exports = exports;
 
 const path = require('path');
 const semver = require('semver');
-const url = require('url');
+const { URL } = require('url');
 const detect_libc = require('detect-libc');
 const napi = require('./napi.js');
 
@@ -221,7 +221,12 @@ function validate_config(package_json, opts) {
   }
   if (o) {
     // enforce https over http
-    const protocol = url.parse(o.host).protocol;
+    let protocol;
+    try {
+      protocol = new URL(o.host).protocol;
+    } catch {
+      throw new Error("'host' protocol (invalid) is invalid - only 'https:' is accepted");
+    }
     if (protocol === 'http:') {
       throw new Error("'host' protocol (" + protocol + ") is invalid - only 'https:' is accepted");
     }
@@ -332,11 +337,12 @@ module.exports.evaluate = function(package_json, options, napi_build_version) {
   opts.staged_tarball = path.join('build/stage', opts.remote_path, opts.package_name);
   // when using s3ForcePathStyle the bucket is part of the http object path
   // add it
+  const resolveUrl = (base, relative) => new URL(relative, base).toString();
   if (opts.s3ForcePathStyle) {
-    opts.hosted_path = url.resolve(opts.host, drop_double_slashes(`${opts.bucket}/${opts.remote_path}`));
+    opts.hosted_path = resolveUrl(opts.host, drop_double_slashes(`${opts.bucket}/${opts.remote_path}`));
   } else {
-    opts.hosted_path = url.resolve(opts.host, opts.remote_path);
+    opts.hosted_path = resolveUrl(opts.host, opts.remote_path);
   }
-  opts.hosted_tarball = url.resolve(opts.hosted_path, opts.package_name);
+  opts.hosted_tarball = resolveUrl(opts.hosted_path, opts.package_name);
   return opts;
 };
